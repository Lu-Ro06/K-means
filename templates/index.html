<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Detección de Fraude - K-means (K=6)</title>

    <style>
        /* RESET */
        * { margin: 0; padding: 0; box-sizing: border-box; }

        /* PALETA AZUL · MORADO · NEGRO MATE */
        :root {
            --bg-main: #0b0d14;
            --bg-secondary: #111427;
            --bg-card: rgba(255, 255, 255, 0.04);

            --blue: #5c7cfa;
            --purple: #9b7bff;

            --text-main: #e8ebff;
            --text-muted: #a0a6d8;

            --border-soft: rgba(255,255,255,0.12);
            --shadow-main: 0 12px 35px rgba(0,0,0,0.7);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: radial-gradient(circle at top, #15193a, #07080f 70%);
            color: var(--text-main);
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: linear-gradient(135deg, #12163a, #0b0d1f);
            padding: 40px 20px;
            text-align: center;
            border-bottom: 3px solid var(--blue);
            box-shadow: var(--shadow-main);
            margin-bottom: 30px;
        }

        h1 {
            color: var(--blue);
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .subtitle {
            color: var(--text-muted);
            font-size: 1.1em;
        }

        .section {
            background: var(--bg-card);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-soft);
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: var(--shadow-main);
        }

        h2 {
            color: var(--purple);
            margin-bottom: 20px;
            font-size: 1.8em;
            border-bottom: 2px solid rgba(155,123,255,.4);
            padding-bottom: 10px;
        }

        h3 {
            color: var(--blue);
            margin: 20px 0 15px 0;
            font-size: 1.3em;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .info-card {
            background: rgba(92,124,250,.12);
            border-left: 4px solid var(--blue);
            padding: 20px;
            border-radius: 8px;
        }

        .info-card h4 {
            color: var(--blue);
            margin-bottom: 10px;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .info-card p {
            font-size: 1.8em;
            font-weight: bold;
            color: #fff;
        }

        .features-list {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin: 20px 0;
        }

        .feature-badge {
            background: linear-gradient(135deg, var(--blue), var(--purple));
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: bold;
            color: #fff;
            box-shadow: 0 4px 12px rgba(0,0,0,.4);
        }

        .plot-container {
            text-align: center;
            margin: 30px 0;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
        }

        .plot-container img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,.6);
        }

        .description {
            background: rgba(155,123,255,.08);
            border-left: 4px solid var(--purple);
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            font-size: 1.05em;
            line-height: 1.8;
        }

        .cluster-card {
            background: linear-gradient(135deg, rgba(92,124,250,.15), rgba(155,123,255,.15));
            border: 1px solid var(--border-soft);
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            transition: transform 0.3s ease;
        }

        .cluster-card:hover {
            transform: translateX(10px);
            border-color: var(--blue);
        }

        .cluster-label {
            font-size: 1.5em;
            font-weight: bold;
            color: var(--purple);
            margin-bottom: 10px;
        }

        .cluster-stats {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 15px;
        }

        .stat {
            flex: 1;
            min-width: 120px;
        }

        .stat-label {
            color: var(--text-muted);
            font-size: 0.9em;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 1.4em;
            font-weight: bold;
            color: var(--blue);
        }

        .malicious {
            color: var(--purple) !important;
        }

        .metric-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .metric-box {
            background: linear-gradient(135deg, rgba(92,124,250,.25), rgba(155,123,255,.25));
            border: 2px solid var(--blue);
            border-radius: 10px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .metric-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,.6);
        }

        .metric-name {
            color: var(--text-muted);
            font-size: 0.95em;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .metric-value {
            color: var(--blue);
            font-size: 2.2em;
            font-weight: bold;
        }

        .alert-box {
            background: rgba(155,123,255,.12);
            border: 2px solid var(--purple);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .alert-box h4 {
            color: var(--purple);
            margin-bottom: 10px;
        }

        footer {
            text-align: center;
            padding: 30px;
            color: var(--text-muted);
            margin-top: 50px;
        }

        @media (max-width: 768px) {
            h1 { font-size: 1.8em; }
            .cluster-stats { flex-direction: column; }
            .metric-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>


<body>
    <header>
        <h1> Sistema de Detección de Fraude Bancario</h1>
        <p class="subtitle">Análisis de transacciones mediante K-means Clustering (K=6)</p>
    </header>

    <div class="container">
        <section class="section">
            <h2> Contexto del Problema</h2>
            <div class="description">
                <p style="margin-bottom: 15px;">Este dataset contiene 284,807 transacciones donde solo 492 son fraudulentas (0.172%).</p>
                <div class="alert-box">
                    <h4> Dataset Altamente Desbalanceado</h4>
                    <p>El reto es encontrar patrones de fraude en una masa ingente de datos legítimos.</p>
                </div>
            </div>
        </section>

        <section class="section">
            <h2> Información del Dataset</h2>
            <div class="info-grid">
                <div class="info-card"><h4>Total</h4><p>{{ "{:,}".format(dataset.shape[0]) }}</p></div>
                <div class="info-card"><h4>Características</h4><p>{{ dataset.shape[1] }}</p></div>
                <div class="info-card"><h4>Normales</h4><p>{{ "{:,}".format(dataset.class_distribution[0]) }}</p></div>
                <div class="info-card"><h4>Fraudes</h4><p style="color: #e94560;">{{ "{:,}".format(dataset.class_distribution[1]) }}</p></div>
            </div>
            
            <h3>Características Principales (Random Forest)</h3>
            <div class="features-list">
                {% for feature in dataset.top_features %}<div class="feature-badge">{{ feature }}</div>{% endfor %}
            </div>
        </section>

        <section class="section">
            <h2> Análisis Visual</h2>
            <div class="plot-container">
                <img src="{{ url_for('static', filename='images/Code.png') }}" alt="Distribución">
            </div>
            <div class="plot-container">
                <img src="{{ url_for('static', filename='images/Code2.png') }}" alt="Clusters">
            </div>
        </section>

        <section class="section">
            <h2> Resultados del Clustering (K=6)</h2>
            <div class="alert-box">
                <h4>Configuración: 6 Clusters</h4>
                <p>Al utilizar 6 grupos, logramos una mejor separación del fraude en el espacio de componentes principales.</p>
            </div>
            
            {% for cluster in clusters %}
            <div class="cluster-card">
                <div class="cluster-label">Cluster {{ cluster.label }}</div>
                <div class="cluster-stats">
                    <div class="stat"><div class="stat-label">Total</div><div class="stat-value">{{ "{:,}".format(cluster.total) }}</div></div>
                    <div class="stat"><div class="stat-label">Maliciosas</div><div class="stat-value malicious">{{ cluster.malicious }}</div></div>
                    <div class="stat"><div class="stat-label">% Riesgo</div><div class="stat-value malicious">{{ cluster.percentage }}%</div></div>
                </div>
            </div>
            {% endfor %}
            
            <div class="description">
                <strong>Análisis de los 6 Clusters:</strong> El <strong>Cluster 4</strong> captura la mayor densidad de fraude (87.77%), mientras que el nuevo <strong>Cluster 5</strong> ayuda a filtrar transacciones de riesgo bajo.
            </div>
        </section>

        <section class="section">
            <h2> Evaluación del Modelo</h2>
            <div class="metric-grid">
                <div class="metric-box"><div class="metric-name">Purity</div><div class="metric-value">{{ metrics.purity }}</div></div>
                <div class="metric-box"><div class="metric-name">Silhouette</div><div class="metric-value">{{ metrics.silhouette }}</div></div>
                <div class="metric-box"><div class="metric-name">Calinski</div><div class="metric-value">{{ "{:,.0f}".format(metrics.calinski) }}</div></div>
            </div>
        </section>
    </div>

  
</body>
</html>